<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>事件循环</title>
</head>

<body>
    <button class="time-btn">点击网页变成粉色</button>
    <script>
        // 此文件没有在PPT和视频出现，供大家自己思考JS是单线程使用
        // 点击执行30w次打印
        // 体验JS是单线程的，必须先遍历完，才能改变颜色
        // 事件循环：执行代码和收集异步任务，在调用栈空闲时，反复调用任务队列里回调函数执行机制
        // 设计原因：JavaScript 是单线程的，为了不阻塞 JS 引擎，设计执行代码的模型
        // 执行同步代码，遇到异步代码交给宿主浏览器环境执行，异步有了结果后，把回调函数放入任务队列排队
        // 当调用栈空闲后，反复调用任务队列里的回调函数
        document.querySelector('.time-btn').addEventListener('click', () => {
            for (let i = 0; i < 300000; i++) {
                console.log(i)
            }
            document.body.style.background = 'pink'
        })

        // 为了避免线程卡死，出现了异步代码，把耗时操作放到异步中，先保证主线程执行完所有同步代码
        document.querySelector('.time-btn').addEventListener('click', () => {
            setTimeout(() => {
                for (let i = 0; i < 300000; i++) {
                    console.log(i)
                }
            }, 0)
            document.body.style.background = 'pink'
        })
    </script>
</body>

</html>